<!doctype html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Números - Signealo</title>
        <link rel="stylesheet" href="../../style.css" />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
        />
        <style>
            .mode-switch {
                display: flex;
                gap: 10px;
                margin-bottom: 20px;
                justify-content: center;
            }
            .mode-btn {
                padding: 8px 16px;
                border: none;
                background: #e5e7eb;
                border-radius: 20px;
                cursor: pointer;
                font-weight: bold;
            }
            .mode-btn.active {
                background: var(--primary-color);
                color: white;
            }
            #quiz-panel {
                display: none;
                text-align: center;
            }
        </style>
    </head>
    <body>
        <header class="page-header">
            <a href="../../caracteristicas.html" class="back-btn"
                ><i class="bi bi-arrow-left"></i
            ></a>
            <h1>Números</h1>
        </header>

        <main class="container" style="margin-top: 20px">
            <div class="mode-switch">
                <button
                    class="mode-btn active"
                    onclick="setMode('explore')"
                    id="btn-explore"
                >
                    Explorar
                </button>
                <button
                    class="mode-btn"
                    onclick="setMode('quiz')"
                    id="btn-quiz"
                >
                    Quiz
                </button>
            </div>

            <div class="viewer-box" id="viewer">
                <p>Selecciona un número</p>
            </div>

            <!-- Exploración -->
            <div class="keyboard-grid" id="keyboard"></div>

            <!-- Quiz -->
            <div id="quiz-panel">
                <h3 id="quiz-score">Puntos: 0</h3>
                <div class="keyboard-grid" id="quiz-options"></div>
            </div>
        </main>

        <script>
            const numbers = Array.from({ length: 10 }, (_, i) => i + 1); // 1 al 10
            const board = document.getElementById("keyboard");
            const viewer = document.getElementById("viewer");
            const quizPanel = document.getElementById("quiz-panel");
            const quizOptions = document.getElementById("quiz-options");
            const assetsPath = "../../assets/";
            let currentScore = 0;
            let currentTarget = null;

            // Inicializar Teclado
            numbers.forEach((num) => {
                const btn = document.createElement("button");
                btn.className = "key-btn";
                btn.textContent = num;
                btn.onclick = () => showImage(num);
                board.appendChild(btn);
            });

            function showImage(num) {
                // Lógica simple para cargar imagen
                viewer.innerHTML = `<img src="${assetsPath}${num}.jpeg" onerror="this.src='${assetsPath}${num}.jpg'; this.onerror=null; this.parentNode.innerHTML='<h1>${num}</h1>'">`;
            }

            function setMode(mode) {
                document
                    .querySelectorAll(".mode-btn")
                    .forEach((b) => b.classList.remove("active"));
                document.getElementById(`btn-${mode}`).classList.add("active");

                if (mode === "explore") {
                    board.style.display = "flex";
                    quizPanel.style.display = "none";
                    viewer.innerHTML = "<p>Selecciona un número</p>";
                } else {
                    board.style.display = "none";
                    quizPanel.style.display = "block";
                    currentScore = 0;
                    nextQuestion();
                }
            }

            function nextQuestion() {
                document.getElementById("quiz-score").innerText =
                    `Puntos: ${currentScore}`;
                currentTarget =
                    numbers[Math.floor(Math.random() * numbers.length)];

                // Mostrar imagen a adivinar
                showImage(currentTarget);

                // Generar opciones (el correcto + 3 incorrectos)
                quizOptions.innerHTML = "";
                let opts = [currentTarget];
                while (opts.length < 4) {
                    let r = numbers[Math.floor(Math.random() * numbers.length)];
                    if (!opts.includes(r)) opts.push(r);
                }
                opts.sort(() => Math.random() - 0.5); // Mezclar

                opts.forEach((opt) => {
                    const btn = document.createElement("button");
                    btn.className = "key-btn";
                    btn.textContent = opt;
                    btn.style.width = "80px"; // Más ancho para quiz
                    btn.onclick = () => {
                        if (opt === currentTarget) {
                            currentScore++;
                            btn.style.background = "#10b981"; // Verde
                            setTimeout(nextQuestion, 500);
                        } else {
                            btn.style.background = "#ef4444"; // Rojo
                            currentScore = Math.max(0, currentScore - 1);
                            document.getElementById("quiz-score").innerText =
                                `Puntos: ${currentScore}`;
                        }
                        btn.style.color = "white";
                    };
                    quizOptions.appendChild(btn);
                });
            }
        </script>
    </body>
</html>
